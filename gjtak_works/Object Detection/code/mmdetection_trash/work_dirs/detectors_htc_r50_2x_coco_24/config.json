{
	"dataset_type": "CocoDataset",
	"data_root": "data/coco/",
	"img_norm_cfg": {
		"mean": [
			123.675,
			116.28,
			103.53
		],
		"std": [
			58.395,
			57.12,
			57.375
		],
		"to_rgb": true
	},
	"train_pipeline": [
		{
			"type": "LoadImageFromFile"
		},
		{
			"type": "LoadAnnotations",
			"with_bbox": true,
			"with_mask": true,
			"with_seg": true
		},
		{
			"type": "Resize",
			"img_scale": [
				1333,
				800
			],
			"keep_ratio": true
		},
		{
			"type": "RandomFlip",
			"flip_ratio": 0.5
		},
		{
			"type": "Normalize",
			"mean": [
				123.675,
				116.28,
				103.53
			],
			"std": [
				58.395,
				57.12,
				57.375
			],
			"to_rgb": true
		},
		{
			"type": "Pad",
			"size_divisor": 32
		},
		{
			"type": "SegRescale",
			"scale_factor": 0.125
		},
		{
			"type": "DefaultFormatBundle"
		},
		{
			"type": "Collect",
			"keys": [
				"img",
				"gt_bboxes",
				"gt_labels",
				"gt_masks",
				"gt_semantic_seg"
			]
		}
	],
	"test_pipeline": [
		{
			"type": "LoadImageFromFile"
		},
		{
			"type": "MultiScaleFlipAug",
			"img_scale": [
				1333,
				800
			],
			"flip": false,
			"transforms": [
				{
					"type": "Resize",
					"keep_ratio": true
				},
				{
					"type": "RandomFlip",
					"flip_ratio": 0.5
				},
				{
					"type": "Normalize",
					"mean": [
						123.675,
						116.28,
						103.53
					],
					"std": [
						58.395,
						57.12,
						57.375
					],
					"to_rgb": true
				},
				{
					"type": "Pad",
					"size_divisor": 32
				},
				{
					"type": "ImageToTensor",
					"keys": [
						"img"
					]
				},
				{
					"type": "Collect",
					"keys": [
						"img"
					]
				}
			]
		}
	],
	"data": {
		"samples_per_gpu": 16,
		"workers_per_gpu": 4,
		"train": {
			"type": "CocoDataset",
			"ann_file": "/opt/ml/input/data/train.json",
			"img_prefix": "/opt/ml/input/data/",
			"pipeline": [
				{
					"type": "LoadImageFromFile"
				},
				{
					"type": "LoadAnnotations",
					"with_bbox": true,
					"with_mask": true,
					"with_seg": true
				},
				{
					"type": "Resize",
					"img_scale": [
						512,
						512
					],
					"keep_ratio": true
				},
				{
					"type": "RandomFlip",
					"flip_ratio": 0.5
				},
				{
					"type": "Normalize",
					"mean": [
						123.675,
						116.28,
						103.53
					],
					"std": [
						58.395,
						57.12,
						57.375
					],
					"to_rgb": true
				},
				{
					"type": "Pad",
					"size_divisor": 32
				},
				{
					"type": "SegRescale",
					"scale_factor": 0.125
				},
				{
					"type": "DefaultFormatBundle"
				},
				{
					"type": "Collect",
					"keys": [
						"img",
						"gt_bboxes",
						"gt_labels",
						"gt_masks",
						"gt_semantic_seg"
					]
				}
			],
			"seg_prefix": "data/coco/stuffthingmaps/train2017/",
			"classes": [
				"UNKNOWN",
				"General trash",
				"Paper",
				"Paper pack",
				"Metal",
				"Glass",
				"Plastic",
				"Styrofoam",
				"Plastic bag",
				"Battery",
				"Clothing"
			]
		},
		"val": {
			"type": "CocoDataset",
			"ann_file": "/opt/ml/input/data/val.json",
			"img_prefix": "/opt/ml/input/data/",
			"pipeline": [
				{
					"type": "LoadImageFromFile"
				},
				{
					"type": "MultiScaleFlipAug",
					"img_scale": [
						512,
						512
					],
					"flip": false,
					"transforms": [
						{
							"type": "Resize",
							"keep_ratio": true
						},
						{
							"type": "RandomFlip",
							"flip_ratio": 0.5
						},
						{
							"type": "Normalize",
							"mean": [
								123.675,
								116.28,
								103.53
							],
							"std": [
								58.395,
								57.12,
								57.375
							],
							"to_rgb": true
						},
						{
							"type": "Pad",
							"size_divisor": 32
						},
						{
							"type": "ImageToTensor",
							"keys": [
								"img"
							]
						},
						{
							"type": "Collect",
							"keys": [
								"img"
							]
						}
					]
				}
			],
			"classes": [
				"UNKNOWN",
				"General trash",
				"Paper",
				"Paper pack",
				"Metal",
				"Glass",
				"Plastic",
				"Styrofoam",
				"Plastic bag",
				"Battery",
				"Clothing"
			]
		},
		"test": {
			"type": "CocoDataset",
			"ann_file": "/opt/ml/input/data/test.json",
			"img_prefix": "/opt/ml/input/data/",
			"pipeline": [
				{
					"type": "LoadImageFromFile"
				},
				{
					"type": "MultiScaleFlipAug",
					"img_scale": [
						512,
						512
					],
					"flip": false,
					"transforms": [
						{
							"type": "Resize",
							"keep_ratio": true
						},
						{
							"type": "RandomFlip",
							"flip_ratio": 0.5
						},
						{
							"type": "Normalize",
							"mean": [
								123.675,
								116.28,
								103.53
							],
							"std": [
								58.395,
								57.12,
								57.375
							],
							"to_rgb": true
						},
						{
							"type": "Pad",
							"size_divisor": 32
						},
						{
							"type": "ImageToTensor",
							"keys": [
								"img"
							]
						},
						{
							"type": "Collect",
							"keys": [
								"img"
							]
						}
					]
				}
			],
			"classes": [
				"UNKNOWN",
				"General trash",
				"Paper",
				"Paper pack",
				"Metal",
				"Glass",
				"Plastic",
				"Styrofoam",
				"Plastic bag",
				"Battery",
				"Clothing"
			]
		}
	},
	"evaluation": {
		"metric": [
			"bbox",
			"segm"
		]
	},
	"optimizer": {
		"type": "SGD",
		"lr": 0.02,
		"momentum": 0.9,
		"weight_decay": 0.0001
	},
	"optimizer_config": {
		"grad_clip": {
			"max_norm": 35,
			"norm_type": 2
		}
	},
	"lr_config": {
		"policy": "step",
		"warmup": "linear",
		"warmup_iters": 500,
		"warmup_ratio": 0.001,
		"step": [
			16,
			19
		]
	},
	"runner": {
		"type": "EpochBasedRunner",
		"max_epochs": 24
	},
	"checkpoint_config": {
		"interval": 1
	},
	"log_config": {
		"interval": 10,
		"hooks": [
			{
				"type": "TextLoggerHook"
			},
			{
				"type": "WandbLoggerHook",
				"init_kwargs": {
					"project": "gjtak",
					"group": "detectors",
					"name": "detectors_htc_r50_2x_coco",
					"config": {
						"epoch": 24,
						"batch_size": 16,
						"optimizer": {
							"type": "SGD",
							"lr": 0.02,
							"momentum": 0.9,
							"weight_decay": 0.0001
						},
						"optimizer_config": {
							"grad_clip": {
								"max_norm": 35,
								"norm_type": 2
							}
						},
						"lr_config": {
							"policy": "step",
							"warmup": "linear",
							"warmup_iters": 500,
							"warmup_ratio": 0.001,
							"step": [
								16,
								19
							]
						}
					}
				}
			}
		]
	},
	"custom_hooks": [
		{
			"type": "NumClassCheckHook"
		}
	],
	"dist_params": {
		"backend": "nccl"
	},
	"log_level": "INFO",
	"load_from": null,
	"resume_from": null,
	"workflow": [
		[
			"train",
			1
		]
	],
	"model": {
		"type": "HybridTaskCascade",
		"pretrained": "torchvision://resnet50",
		"backbone": {
			"type": "DetectoRS_ResNet",
			"depth": 50,
			"num_stages": 4,
			"out_indices": [
				0,
				1,
				2,
				3
			],
			"frozen_stages": 1,
			"norm_cfg": {
				"type": "BN",
				"requires_grad": true
			},
			"norm_eval": true,
			"style": "pytorch",
			"conv_cfg": {
				"type": "ConvAWS"
			},
			"sac": {
				"type": "SAC",
				"use_deform": true
			},
			"stage_with_sac": [
				false,
				true,
				true,
				true
			],
			"output_img": true
		},
		"neck": {
			"type": "RFP",
			"in_channels": [
				256,
				512,
				1024,
				2048
			],
			"out_channels": 256,
			"num_outs": 5,
			"rfp_steps": 2,
			"aspp_out_channels": 64,
			"aspp_dilations": [
				1,
				3,
				6,
				1
			],
			"rfp_backbone": {
				"rfp_inplanes": 256,
				"type": "DetectoRS_ResNet",
				"depth": 50,
				"num_stages": 4,
				"out_indices": [
					0,
					1,
					2,
					3
				],
				"frozen_stages": 1,
				"norm_cfg": {
					"type": "BN",
					"requires_grad": true
				},
				"norm_eval": true,
				"conv_cfg": {
					"type": "ConvAWS"
				},
				"sac": {
					"type": "SAC",
					"use_deform": true
				},
				"stage_with_sac": [
					false,
					true,
					true,
					true
				],
				"pretrained": "torchvision://resnet50",
				"style": "pytorch"
			}
		},
		"rpn_head": {
			"type": "RPNHead",
			"in_channels": 256,
			"feat_channels": 256,
			"anchor_generator": {
				"type": "AnchorGenerator",
				"scales": [
					8
				],
				"ratios": [
					0.5,
					1.0,
					2.0
				],
				"strides": [
					4,
					8,
					16,
					32,
					64
				]
			},
			"bbox_coder": {
				"type": "DeltaXYWHBBoxCoder",
				"target_means": [
					0.0,
					0.0,
					0.0,
					0.0
				],
				"target_stds": [
					1.0,
					1.0,
					1.0,
					1.0
				]
			},
			"loss_cls": {
				"type": "CrossEntropyLoss",
				"use_sigmoid": true,
				"loss_weight": 1.0
			},
			"loss_bbox": {
				"type": "SmoothL1Loss",
				"beta": 0.1111111111111111,
				"loss_weight": 1.0
			}
		},
		"roi_head": {
			"type": "HybridTaskCascadeRoIHead",
			"interleaved": true,
			"mask_info_flow": true,
			"num_stages": 3,
			"stage_loss_weights": [
				1,
				0.5,
				0.25
			],
			"bbox_roi_extractor": {
				"type": "SingleRoIExtractor",
				"roi_layer": {
					"type": "RoIAlign",
					"output_size": 7,
					"sampling_ratio": 0
				},
				"out_channels": 256,
				"featmap_strides": [
					4,
					8,
					16,
					32
				]
			},
			"bbox_head": [
				{
					"type": "Shared2FCBBoxHead",
					"in_channels": 256,
					"fc_out_channels": 1024,
					"roi_feat_size": 7,
					"num_classes": 11,
					"bbox_coder": {
						"type": "DeltaXYWHBBoxCoder",
						"target_means": [
							0.0,
							0.0,
							0.0,
							0.0
						],
						"target_stds": [
							0.1,
							0.1,
							0.2,
							0.2
						]
					},
					"reg_class_agnostic": true,
					"loss_cls": {
						"type": "CrossEntropyLoss",
						"use_sigmoid": false,
						"loss_weight": 1.0
					},
					"loss_bbox": {
						"type": "SmoothL1Loss",
						"beta": 1.0,
						"loss_weight": 1.0
					}
				},
				{
					"type": "Shared2FCBBoxHead",
					"in_channels": 256,
					"fc_out_channels": 1024,
					"roi_feat_size": 7,
					"num_classes": 11,
					"bbox_coder": {
						"type": "DeltaXYWHBBoxCoder",
						"target_means": [
							0.0,
							0.0,
							0.0,
							0.0
						],
						"target_stds": [
							0.05,
							0.05,
							0.1,
							0.1
						]
					},
					"reg_class_agnostic": true,
					"loss_cls": {
						"type": "CrossEntropyLoss",
						"use_sigmoid": false,
						"loss_weight": 1.0
					},
					"loss_bbox": {
						"type": "SmoothL1Loss",
						"beta": 1.0,
						"loss_weight": 1.0
					}
				},
				{
					"type": "Shared2FCBBoxHead",
					"in_channels": 256,
					"fc_out_channels": 1024,
					"roi_feat_size": 7,
					"num_classes": 11,
					"bbox_coder": {
						"type": "DeltaXYWHBBoxCoder",
						"target_means": [
							0.0,
							0.0,
							0.0,
							0.0
						],
						"target_stds": [
							0.033,
							0.033,
							0.067,
							0.067
						]
					},
					"reg_class_agnostic": true,
					"loss_cls": {
						"type": "CrossEntropyLoss",
						"use_sigmoid": false,
						"loss_weight": 1.0
					},
					"loss_bbox": {
						"type": "SmoothL1Loss",
						"beta": 1.0,
						"loss_weight": 1.0
					}
				}
			],
			"mask_roi_extractor": {
				"type": "SingleRoIExtractor",
				"roi_layer": {
					"type": "RoIAlign",
					"output_size": 14,
					"sampling_ratio": 0
				},
				"out_channels": 256,
				"featmap_strides": [
					4,
					8,
					16,
					32
				]
			},
			"mask_head": [
				{
					"type": "HTCMaskHead",
					"with_conv_res": false,
					"num_convs": 4,
					"in_channels": 256,
					"conv_out_channels": 256,
					"num_classes": 11,
					"loss_mask": {
						"type": "CrossEntropyLoss",
						"use_mask": true,
						"loss_weight": 1.0
					}
				},
				{
					"type": "HTCMaskHead",
					"num_convs": 4,
					"in_channels": 256,
					"conv_out_channels": 256,
					"num_classes": 11,
					"loss_mask": {
						"type": "CrossEntropyLoss",
						"use_mask": true,
						"loss_weight": 1.0
					}
				},
				{
					"type": "HTCMaskHead",
					"num_convs": 4,
					"in_channels": 256,
					"conv_out_channels": 256,
					"num_classes": 11,
					"loss_mask": {
						"type": "CrossEntropyLoss",
						"use_mask": true,
						"loss_weight": 1.0
					}
				}
			],
			"semantic_roi_extractor": {
				"type": "SingleRoIExtractor",
				"roi_layer": {
					"type": "RoIAlign",
					"output_size": 14,
					"sampling_ratio": 0
				},
				"out_channels": 256,
				"featmap_strides": [
					8
				]
			},
			"semantic_head": {
				"type": "FusedSemanticHead",
				"num_ins": 5,
				"fusion_level": 1,
				"num_convs": 4,
				"in_channels": 256,
				"conv_out_channels": 256,
				"num_classes": 11,
				"ignore_label": 255,
				"loss_weight": 0.2
			}
		},
		"train_cfg": {
			"rpn": {
				"assigner": {
					"type": "MaxIoUAssigner",
					"pos_iou_thr": 0.7,
					"neg_iou_thr": 0.3,
					"min_pos_iou": 0.3,
					"ignore_iof_thr": -1
				},
				"sampler": {
					"type": "RandomSampler",
					"num": 256,
					"pos_fraction": 0.5,
					"neg_pos_ub": -1,
					"add_gt_as_proposals": false
				},
				"allowed_border": 0,
				"pos_weight": -1,
				"debug": false
			},
			"rpn_proposal": {
				"nms_pre": 2000,
				"max_per_img": 2000,
				"nms": {
					"type": "nms",
					"iou_threshold": 0.7
				},
				"min_bbox_size": 0
			},
			"rcnn": [
				{
					"assigner": {
						"type": "MaxIoUAssigner",
						"pos_iou_thr": 0.5,
						"neg_iou_thr": 0.5,
						"min_pos_iou": 0.5,
						"ignore_iof_thr": -1
					},
					"sampler": {
						"type": "RandomSampler",
						"num": 512,
						"pos_fraction": 0.25,
						"neg_pos_ub": -1,
						"add_gt_as_proposals": true
					},
					"mask_size": 28,
					"pos_weight": -1,
					"debug": false
				},
				{
					"assigner": {
						"type": "MaxIoUAssigner",
						"pos_iou_thr": 0.6,
						"neg_iou_thr": 0.6,
						"min_pos_iou": 0.6,
						"ignore_iof_thr": -1
					},
					"sampler": {
						"type": "RandomSampler",
						"num": 512,
						"pos_fraction": 0.25,
						"neg_pos_ub": -1,
						"add_gt_as_proposals": true
					},
					"mask_size": 28,
					"pos_weight": -1,
					"debug": false
				},
				{
					"assigner": {
						"type": "MaxIoUAssigner",
						"pos_iou_thr": 0.7,
						"neg_iou_thr": 0.7,
						"min_pos_iou": 0.7,
						"ignore_iof_thr": -1
					},
					"sampler": {
						"type": "RandomSampler",
						"num": 512,
						"pos_fraction": 0.25,
						"neg_pos_ub": -1,
						"add_gt_as_proposals": true
					},
					"mask_size": 28,
					"pos_weight": -1,
					"debug": false
				}
			]
		},
		"test_cfg": {
			"rpn": {
				"nms_pre": 1000,
				"max_per_img": 1000,
				"nms": {
					"type": "nms",
					"iou_threshold": 0.7
				},
				"min_bbox_size": 0
			},
			"rcnn": {
				"score_thr": 0.001,
				"nms": {
					"type": "nms",
					"iou_threshold": 0.5
				},
				"max_per_img": 100,
				"mask_thr_binary": 0.5
			}
		}
	},
	"seed": 42,
	"gpu_ids": [
		0
	],
	"work_dir": "../work_dirs/detectors_htc_r50_2x_coco_24"
}